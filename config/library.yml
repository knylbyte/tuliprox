# VOD (Video-on-Demand) Configuration
# This file configures the local VOD module for scanning and serving local video files

# Enable or disable the VOD module
enabled: false

# Directories to scan for video files
scan_directories:
  # Example: Movies directory
  - path: "/media/movies"
    enabled: true

  # Example: TV Shows directory
  - path: "/media/tvshows"
    enabled: true

  # You can add more directories as needed
  # - path: "/mnt/videos"
  #   enabled: false

# Supported video file extensions
supported_extensions:
  - "mp4"
  - "mkv"
  - "avi"
  - "mov"
  - "ts"
  - "m4v"
  - "webm"

# Metadata configuration
metadata:
  # Location to store metadata cache (JSON files)
  storage_location: "./data/vod_metadata"

  # TMDB (The Movie Database) API integration
  tmdb_enabled: false
  tmdb_api_key: ""  # Get your API key from https://www.themoviedb.org/settings/api
  tmdb_rate_limit_ms: 250  # Milliseconds between API calls (default: 250ms)

  # Fallback to filename parsing if no metadata found
  fallback_to_filename_parsing: true

  # Metadata output formats
  formats:
    - "json"  # Always stores JSON metadata
    # - "nfo"  # Optionally write Kodi-compatible NFO files

# Classification rules for movies vs series
classification:
  # Regex patterns to identify series/TV shows
  # If a file/folder name matches any pattern, it's classified as a series
  series_patterns:
    - "(?i)s\\d+e\\d+"          # S01E02 format
    - "(?i)\\d+x\\d+"            # 1x02 format
    - "(?i)season[\\s._-]*\\d+"  # "Season 1" format
    - "(?i)episode[\\s._-]*\\d+" # "Episode 1" format

# Playlist integration
playlist:
  # Group name for movies in M3U/Xtream playlist
  movie_group_name: "VOD Movies"

  # Group name for series in M3U/Xtream playlist
  series_group_name: "VOD Series"

# File serving configuration
file_serving:
  # Method to serve video files
  # Options: "xtream_api" (default) or "m3u"
  method: "xtream_api"

# Examples of usage:
#
# 1. Scan VOD directories from command line:
#    ./tuliprox --scan-vod
#
# 2. Force rescan all files (ignoring modification timestamps):
#    ./tuliprox --force-vod-rescan
#
# 3. Trigger scan via API (requires server mode):
#    POST /api/v1/vod/scan
#    {"force_rescan": false}
#
# 4. Get VOD status via API:
#    GET /api/v1/vod/status
#
# 5. Get specific VOD item by virtual ID:
#    GET /api/v1/vod/item/100

# Metadata sources priority:
# 1. Existing NFO files (Kodi/Jellyfin/Emby/Plex)
# 2. TMDB API (if enabled)
# 3. Filename parsing (if fallback enabled)

# NFO file locations searched:
# - {filename}.nfo (e.g., "The Matrix.nfo" for "The Matrix.mkv")
# - movie.nfo (in the same directory)
# - tvshow.nfo (for TV series)

# Filename parsing examples:
# Movies:
#   - "The.Matrix.1999.1080p.BluRay.mkv" -> Title: "The Matrix", Year: 1999
#   - "Inception (2010) 720p.mp4" -> Title: "Inception", Year: 2010
#
# Series:
#   - "Breaking.Bad.S01E01.mkv" -> Show: "Breaking Bad", Season: 1, Episode: 1
#   - "Game of Thrones 1x01.mp4" -> Show: "Game of Thrones", Season: 1, Episode: 1

# Virtual IDs:
# - Each video file gets a unique virtual ID (incrementally assigned)
# - Virtual IDs are stable across scans (tracked by UUID)
# - Deleted files release their virtual IDs for reuse
